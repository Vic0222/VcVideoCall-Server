syntax = "proto3";

option csharp_namespace = "VcGrpcService";

package chat;

// The greeting service definition.
service Chat {
  // Sends a greeting
  rpc Join(stream JoinRequest) returns (stream JoinReply);
  rpc GetRooms(RoomRequest) returns (RoomListReply);
}

message JoinRequest{
  bool initial = 1;
  MessageRequest message_request = 2;
}


message JoinReply{
  bool confirmation = 1;
  Notification notification = 2;
}

message Notification {
  string room_id = 1;
  string sender = 2;
  string message_body = 3;
}

message MessageRequest {
  string target = 1;
  string room_id = 2;
  RoomTypeReply type = 3;
  string message_body = 4;
}

message RoomRequest{
}

message RoomListReply{
  repeated RoomReply rooms = 1;
}

message RoomReply{
  string id = 1;
  string name = 2;
  RoomTypeReply type = 3;
  string last_message = 4;
  int64 last_message_datetime = 5;
}

enum RoomTypeReply {
  Unknown = 0;
  Private = 1;
  Group = 2;
}

